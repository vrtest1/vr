<html>
    <!-- ソースコードはフリーですが画像は変えてね^^ -->
<head>
    <link rel="stylesheet" href="./index.css">
    <script
        src="https://code.jquery.com/jquery-3.5.0.min.js"
        integrity="sha256-xNzN2a4ltkB44Mc/Jz3pT4iU1cmeR0FkXs4pru/JxaQ="
        crossorigin="anonymous">
    </script>
</head>

<body>
<div class="content">
    <div class="padding">
        <p style="color:white;">melon</p>
    </div>

    <div id="anim_img_box">
        <img id="anim_img" src="anim/hamoni_sp(1).jpeg" style="width: 100%;"/> <!--初期画像を入れておくよ。置き換わる部分だよ-->
    </div>

    <div id="anim_img_padding" class="padding">
        このエリアは画像を動かすためにスクロールされますが、重なっているので見えません。<br>
        このサイズはJavaScriptで変わります。
    </div>
    <div class="padding">
        <p style="color:white">Cut'em all.</p>
    </div>
</div>

</body>
<script>   
    var tmp = {};
    loadImageToTmp();
    function loadImageToTmp(){
        for(var i=1;i<=38;i++){
            const _i = i;
            const img = new Image();
            tmp[_i] = null;
            img.src = "anim/hamoni_sp("+_i+").jpeg";
            img.addEventListener("load",()=>{
                tmp[_i] = img;
            })
        }
    }

    const image = document.getElementById("anim_img");

    var SIZE = 38;

    const offset = $("#anim_img_box").offset(); // 画像を入れるdiv要素
    $(window).scroll(function() {
        const y = $(window).scrollTop();
        const dy = y - offset.top;
        if(offset.top<y&&y<offset.top+SIZE*5){
            $("#anim_img_box").css("top",0)
            const i = Math.floor(dy / 5);
            if(i<=0||i>=SIZE) return;
            if(tmp[i].src) image.src = tmp[i].src;
        }else if(y>=offset.top+SIZE*5){
            $("#anim_img_box").css("top","-"+(dy-SIZE*5))
        }
    }); 

    $("#anim_img_padding").height(SIZE*5); // スペースの変更
    
    </script>
</html>
